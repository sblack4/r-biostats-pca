---
title: "PCA_ALD_viz"
author: "Steven Black"
date: "4/21/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Libraries 
```{r}
library("factoextra")
```


## Data 
```{r}
ALD <- read.csv("data/Ordered Team4-ALD_4cohort_dataset.csv")
```


### Group Data 
```{r}
control <- ALD[1:25, 3:152]
control_AC <- ALD[26:45, 3:152]
mild_AH <- ALD[46:55, 3:152]
severe_AH <- ALD[56:78, 3:152]
```

### Average each group 
```{r}
control_avg <- colMeans(control)
control_AC_avg <- colMeans(control_AC)
mild_AH_avg <- colMeans(mild_AH)
severe_AH_avg <- colMeans(severe_AH)
```

### Combine all groups 
```{r}
all <- rbind(control_avg, control_AC_avg, mild_AH_avg, severe_AH_avg)
```

## PCA 
```{r}
all_pca <- prcomp(all, scale=TRUE)
summary(all_pca)
```

### Viz PCA 
```{r}
fviz_pca_biplot(all_pca, label = "none",
                title = "Bacterial Species in Four Cohorts ALD",
                habillage =  c("control_avg", "control_AC_avg", "mild_AH_avg", "severe_AH_avg"),
                addElipses = TRUE, elipse.level=1,
                ggtheme=theme_minimal())

fviz_pca_var(all_pca,                 
             title = "Bacterial Species in Four Cohorts ALD",
             col.ind = colnames(all), 
             label="none", addElipse=TRUE)
fviz_pca_ind(all_pca,                 
             title = "Bacterial Species in Four Cohorts ALD",
             col.ind = c("control_avg", "control_AC_avg", "mild_AH_avg", "severe_AH_avg"), 
             label="none", addElipse=TRUE)
```



```{r}
summary(all_pca)


t_all <- t(all)
cov_all <- cov(t_all)
cov_all
det(cov_all)
# determinant is 0 which means the cohorts are linearly dependent on each other. This means that they can be defined as linear combinations of the others
ALDpca <- prcomp(t_all, scale=TRUE)
summary(ALDpca)
(eigen_ALD <- ALDpca$sdev^2)
fviz_pca_biplot(ALDpca, 
                title = "Bacterial Species foo",
                pallette = "jco")

fviz_pca_biplot(ALDpca, label = "var",
                title = "Bacterial Species in Four Cohorts ALD",
                addElipses = TRUE, elipse.level=1,
                ggtheme=theme_minimal())

fviz_pca_var(ALDpca,                 
             title = "Bacterial Species in Four Cohorts ALD",
             col.ind = colnames(all), 
             label="none", addElipse=TRUE)
fviz_pca_ind(ALDpca,                 
             title = "Bacterial Species in Four Cohorts ALD",
             label="none", addElipse=TRUE)

```

